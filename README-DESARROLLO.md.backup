# Gatekeeper - GuÃ­a de Desarrollo Local âœ…

## ğŸš€ AplicaciÃ³n Funcionando

**URL:** http://localhost

**Credenciales Admin:**

-   Email: `admin@admin.com`
-   Password: `admin`

---

## ğŸ“‹ Servicios Activos

-   **Laravel App**: Puerto 80 (http://localhost)
-   **Vite Dev Server**: Puerto 5173
-   **Redis**: Puerto 6379
-   **Mailpit**: Puerto 8025 (http://localhost:8025)
-   **Base de Datos**: SQLite (`database/database.sqlite`)

---

## ğŸ› ï¸ Comandos Diarios

### Levantar el proyecto

```bash
cd /home/erwindayan/Documentos/app-gatekepper
sudo ./vendor/bin/sail up -d
```

### Detener el proyecto

```bash
sudo ./vendor/bin/sail down
```

### Ver logs en tiempo real

```bash
sudo docker logs -f app-gatekepper-laravel.test-1
```

### Ejecutar comandos artisan

```bash
sudo docker exec app-gatekepper-laravel.test-1 php artisan [comando]
```

### Acceder al contenedor

```bash
sudo docker exec -it app-gatekepper-laravel.test-1 bash
```

---

## ğŸ”§ ConfiguraciÃ³n Importante

### SELinux (Fedora)

Para que Docker pueda montar el proyecto correctamente:

```bash
sudo chcon -Rt svirt_sandbox_file_t /home/erwindayan/Documentos/app-gatekepper
```

### Variables de entorno importantes en `.env`

```env
DB_CONNECTION=sqlite
DB_DATABASE=/var/www/html/database/database.sqlite
WWWUSER=1000
WWWGROUP=1000

# Servicios externos (ya configurados)
PUSHER_APP_ID=2034673
PUSHER_APP_KEY=7fa6f3ebe8d4679dd6ac
SENDGRID_API_KEY=SG.4X0UKwtwTZip11y2RCUhhQ...
MAYTAPI_API_KEY=3b35fae0-1bdd-4b2c-81b4-c2f93a8a3d07
```

---

## ğŸ› SoluciÃ³n de Problemas

### El contenedor no arranca

```bash
sudo docker ps -a
sudo docker logs app-gatekepper-laravel.test-1
```

### Error de permisos en archivos

```bash
sudo chcon -Rt svirt_sandbox_file_t /home/erwindayan/Documentos/app-gatekepper
sudo ./vendor/bin/sail down
sudo ./vendor/bin/sail up -d
```

### Limpiar cachÃ©

```bash
sudo docker exec app-gatekepper-laravel.test-1 php artisan cache:clear
sudo docker exec app-gatekepper-laravel.test-1 php artisan config:clear
sudo docker exec app-gatekepper-laravel.test-1 php artisan view:clear
```

### Reconstruir contenedores

```bash
sudo ./vendor/bin/sail down
sudo ./vendor/bin/sail build --no-cache
sudo ./vendor/bin/sail up -d
```

---

## ğŸ“ Notas

-   **MySQL**: Actualmente usando SQLite porque MySQL falla en Sail. SQLite funciona perfectamente para desarrollo.
-   **Frontend**: Vite se compila automÃ¡ticamente cuando levantes Sail.
-   **Mailpit**: Para testing de emails, accede a http://localhost:8025

---

## âœ… Checklist de Inicio

1. [ ] `sudo systemctl start docker`
2. [ ] `cd /home/erwindayan/Documentos/app-gatekepper`
3. [ ] `sudo ./vendor/bin/sail up -d`
4. [ ] Abrir http://localhost en el navegador
5. [ ] Login con admin@admin.com / admin

---

**Ãšltima actualizaciÃ³n:** 4 de noviembre de 2025

### Requisitos Previos

-   Docker instalado y corriendo
-   Usuario agregado al grupo docker (opcional, sino usar `sudo`)

### ğŸ› ï¸ Comandos para Levantar el Proyecto

#### 1. Primera vez (Setup inicial)

```bash
# Instalar dependencias PHP
composer install

# Configurar Sail
php artisan sail:install --with=mysql,redis,mailpit

# Levantar contenedores
sudo ./vendor/bin/sail up -d --build

# Instalar dependencias JS
sudo docker exec -it app-gatekepper-laravel.test-1 npm install

# Migrar base de datos
sudo docker exec -it app-gatekepper-laravel.test-1 php artisan migrate --seed
```

#### 2. Uso diario

```bash
# Levantar servicios
sudo ./vendor/bin/sail up -d

# Compilar frontend (en otra terminal)
sudo docker exec -it app-gatekepper-laravel.test-1 npm run dev

# Detener servicios
sudo ./vendor/bin/sail down
```

### ğŸŒ URLs de Acceso

-   **AplicaciÃ³n Principal**: http://localhost
-   **Mailpit (Testing de emails)**: http://localhost:8025
-   **Vite Dev Server**: http://localhost:5173 o http://localhost:5174

### ğŸ“Š Servicios Incluidos

-   **Laravel App**: Puerto 80
-   **MySQL**: Puerto 3306 (interno)
-   **Redis**: Puerto 6379
-   **Mailpit**: Puerto 8025 (web) / 1025 (SMTP)
-   **Vite**: Puerto 5173/5174

### ğŸ”§ Comandos Ãštiles

```bash
# Ejecutar comandos artisan
sudo ./vendor/bin/sail artisan [comando]

# Ejecutar comandos npm
sudo ./vendor/bin/sail npm [comando]

# Acceder al contenedor
sudo docker exec -it app-gatekepper-laravel.test-1 bash

# Ver logs
sudo docker logs app-gatekepper-laravel.test-1

# Estado de contenedores
sudo docker ps
```

### âš¡ Alias Recomendado

Agregar al `~/.bashrc`:

```bash
alias sail="sudo ./vendor/bin/sail"
```

DespuÃ©s ejecutar: `source ~/.bashrc`

### ğŸ› Troubleshooting

#### MySQL no inicia

Si MySQL falla, usar SQLite temporalmente:

```bash
# En .env cambiar:
DB_CONNECTION=sqlite
DB_DATABASE=/var/www/html/database/database.sqlite

# Crear archivo SQLite
touch database/database.sqlite
```

#### Permisos Docker

```bash
# Agregar usuario al grupo docker
sudo usermod -aG docker $USER
newgrp docker

# O usar sudo en todos los comandos sail
sudo ./vendor/bin/sail [comando]
```

#### Puertos en uso

Si hay conflictos de puertos, modificar en `docker-compose.yml`:

```yaml
ports:
    - "8080:80" # Cambiar puerto local
```

### ğŸ“ Estructura del Proyecto

-   **Frontend**: React + Inertia.js + Vite
-   **Backend**: Laravel + Filament + Livewire
-   **Base de datos**: MySQL (o SQLite para desarrollo)
-   **WebSockets**: Laravel WebSockets
-   **Email**: Mailpit para testing local

### ğŸ¯ PrÃ³ximos Pasos

1. Configurar servicios externos (Pusher, SendGrid, Twilio) en `.env`
2. Resolver problema de MySQL si es necesario
3. Configurar WebSockets para notificaciones en tiempo real
4. Testing y optimizaciÃ³n

---

**Nota**: Esta configuraciÃ³n usa Docker para mantener consistencia entre entornos de desarrollo.
